var orderTotal=0;function checkOrderTotal(t){var e=$("#submit-order");return t<300?e.prop("disabled",!0):e.prop("disabled",!1)}function recalculateOrderTotal(){var t=$("[aria-label=quantity]"),e=$(".cs-cart-product__amount > p:first-child span");orderTotal=0,e.each(function(e,a){let r=parseFloat(a.textContent.split(" ")[0])*parseFloat(t[e].value);$("#subtotal-"+e).text("Итого: "+r.toFixed(2)+" руб."),orderTotal+=r});$(".cs-cart-total-text > p").text("Итого за заказ: "+orderTotal.toFixed(2)+" руб.");checkOrderTotal(orderTotal)}function changeProductQuantity(t,e){$.ajax({type:"POST",url:"/Cart?handler=ChangeProductQuantity",beforeSend:function(t){t.setRequestHeader("XSRF-TOKEN",$('input:hidden[name="__RequestVerificationToken"]').val())},data:{itemId:t,newQuantity:e},cache:!1,success:function(){enableAllInputs(),$(".spinner").css("opacity","0"),recalculateOrderTotal()}})}function disableNotActiveInputs(t){$(".cs-btn-minus").attr("disabled",!0),$(".cs-btn-plus").attr("disabled",!0),$(".input-number").attr("disabled",!0),$("#submit-order").attr("disabled",!0),$(".cs-btn-minus")[t].disabled=!1,$(".cs-btn-plus")[t].disabled=!1,$(".input-number")[t].disabled=!1}function enableAllInputs(){$(".cs-btn-minus").attr("disabled",!1),$(".cs-btn-plus").attr("disabled",!1),$(".input-number").attr("disabled",!1),$("#submit-order").attr("disabled",!1)}$(document).ready(function(){var t;recalculateOrderTotal();$("[aria-label=quantity").on("cut copy paste contextmenu",function(t){t.preventDefault()}),$("[aria-label=quantity]").on("input",function(e){e.preventDefault(),clearTimeout(t);var a=!!$(e.target).is(":focus");let r=e.target,n=e.target.getAttribute("id").split("-")[1];disableNotActiveInputs(n),a&&$(e.target).focus(),(""==r.value||0==r.value||r.value>parseInt($(r).attr("max")))&&(r.value=1);var o=$(".spinner");$(o[n]).css("opacity","1"),t=setTimeout(changeProductQuantity,750,n,r.value)})}),$(document).ready(function(){$("input:radio[data-cs-radio=customer]").on("change",function(t){t.preventDefault(),$("#radio-legal").prop("checked")||($(".cs-cart-form-legal-header").fadeOut(200),$(".cs-cart-form-legal").fadeOut(200),$("label[for=customer-name]").text("ФИО"),$("label[for=customer-contact-person").removeClass("cs-required"),$("label[for=customer-contact-person").fadeOut(200),$("#customer-contact-person").fadeOut(200)),$("#radio-legal").prop("checked")&&($(".cs-cart-form-legal-header").fadeIn(200),$(".cs-cart-form-legal").fadeIn(200),$("label[for=customer-name]").text("Название компании"),$("label[for=customer-contact-person").addClass("cs-required"),$("label[for=customer-contact-person").fadeIn(200),$("#customer-contact-person").fadeIn(200))})}),$(document).ready(function(){$(".product-remove").on("click",function(t){t.preventDefault();let e=t.target.getAttribute("id").split("-")[2];$.ajax({type:"POST",url:"/Cart?handler=RemoveProductFromCart",beforeSend:function(t){t.setRequestHeader("XSRF-TOKEN",$('input:hidden[name="__RequestVerificationToken"]').val())},data:{itemId:e},cache:!1,success:function(){location.reload(!0)}})})}),$(document).ready(function(){$(".cs-required ~ input").on("keyup",function(){$(this).removeClass("cs-invalid")}),$("#submit-order").on("click",function(t){var e=!1;return $(".cs-required ~ input").each(function(){""==$(this).val().trim()&&($(this).addClass("cs-invalid"),e=!0)}),!e||(alert("Пожалуйста, заполните обязательные поля!"),!1)})});